{"version":3,"file":"review-preview-view.js","sourceRoot":"","sources":["review-preview-view.ts"],"names":["ReVIEWPreviewView","ReVIEWPreviewView.constructor","ReVIEWPreviewView.deserialize","ReVIEWPreviewView.content","ReVIEWPreviewView.jq","ReVIEWPreviewView.attached","ReVIEWPreviewView.detached","ReVIEWPreviewView.adjustFont","ReVIEWPreviewView.serialize","ReVIEWPreviewView.destroy","ReVIEWPreviewView.resolveEditor","ReVIEWPreviewView.editorForId","ReVIEWPreviewView.handleEvents","ReVIEWPreviewView.renderReVIEW","ReVIEWPreviewView.getTitle","ReVIEWPreviewView.getURI","ReVIEWPreviewView.getPath","ReVIEWPreviewView.showError","ReVIEWPreviewView.showLoading","ReVIEWPreviewView.resolveImagePaths"],"mappings":"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","sourcesContent":["import * as path from \"path\";\n\nimport {$, $$$, ScrollView} from \"atom-space-pen-views\";\n\nimport {File} from \"pathwatcher\";\n\nimport * as V from \"../util/const\";\nimport * as logger from \"../util/logger\";\nimport {ReportLevel} from \"review.js\";\nimport ReVIEWRunner from \"../util/review-runner\";\n\nexport default class ReVIEWPreviewView extends ScrollView {\n\n    editorId: string;\n    file: PathWatcher.IFile;\n    editor: AtomCore.IEditor;\n\n    runner: ReVIEWRunner;\n\n    fontSizeObserveSubscription: AtomCore.IDisposable;\n    fontFamilyObserveSubscription: AtomCore.IDisposable;\n\n    static deserialize(state: any): ReVIEWPreviewView {\n        return new ReVIEWPreviewView(state);\n    }\n\n    static content(): any {\n        return this.div({ class: \"review-preview native-key-bindings\", tabindex: -1 });\n    }\n\n    constructor(params: { editorId?: string; filePath?: string; } = {}) {\n        super();\n\n        this.editorId = params.editorId;\n\n        if (this.editorId) {\n            let promise = this.resolveEditor(this.editorId);\n            promise.then(editor=> {\n                this.runner = new ReVIEWRunner({ editor: editor });\n                this.handleEvents();\n            }).catch(reason=> {\n                // The editor this preview was created for has been closed so close\n                // this preview since a preview cannot be rendered without an editor\n                let view = this.jq.parents(\".pane\").view();\n                if (view) {\n                    view.destroyItem(this);\n                }\n            });\n        } else {\n            this.file = new File(params.filePath);\n            this.runner = new ReVIEWRunner({ file: this.file });\n            this.handleEvents();\n        }\n    }\n\n    get jq(): JQuery {\n        // dirty hack\n        return <any>this;\n    }\n\n    attached() {\n        this.fontSizeObserveSubscription = atom.config.observe(\"editor.fontSize\", newValue => {\n            this.adjustFont({ fontSize: newValue });\n        });\n        this.fontFamilyObserveSubscription = atom.config.observe(\"editor.fontFamily\", newValue => {\n            this.adjustFont({ fontFamily: newValue });\n        });\n    }\n\n    detached() {\n        this.fontSizeObserveSubscription.dispose();\n        this.fontSizeObserveSubscription = null;\n        this.fontFamilyObserveSubscription.dispose();\n        this.fontFamilyObserveSubscription = null;\n    }\n\n    adjustFont({fontSize, fontFamily}: { fontSize?: number; fontFamily?: string }) {\n        fontSize = fontSize || atom.config.get(\"editor.fontSize\");\n        fontFamily = fontFamily || atom.config.get(\"editor.fontFamily\");\n        this.jq.css(\"font-family\", fontFamily);\n        this.jq.css(\"font-size\", fontSize);\n    }\n\n    serialize() {\n        return {\n            deserializer: \"ReVIEWPreviewView\",\n            filePath: this.file ? this.getPath() : null,\n            editorId: this.editorId\n        };\n    }\n\n    destroy() {\n        this.runner.deactivate();\n    }\n\n    resolveEditor(editorId: string): Promise<AtomCore.IEditor> {\n        return new Promise<AtomCore.IEditor>((resolve, reject) => {\n            let func = () => {\n                let editor = this.editorForId(editorId);\n                this.editor = editor;\n\n                if (editor) {\n                    this.jq.trigger(\"title-changed\");\n                    resolve(editor);\n                } else {\n                    reject();\n                }\n            };\n\n            if (atom.workspace) {\n                func();\n            } else {\n                atom.packages.onDidActivateInitialPackages(() => {\n                    func();\n                });\n            }\n        });\n    }\n\n    editorForId(editorId: string) {\n        let foundEditors = atom.workspace.getTextEditors().filter(editor=> {\n            let id = editor.id;\n            if (!id) {\n                return false;\n            }\n            return id.toString() === editorId.toString();\n        });\n        return foundEditors[0];\n    }\n\n    handleEvents() {\n        atom.commands.add(<any>this, \"core:move-up\", () => this.jq.scrollUp());\n        atom.commands.add(<any>this, \"core:move-down\", () => this.jq.scrollDown());\n\n        atom.commands.add(\"atom-workspace\", \"language-review:zoom-in\", () => {\n            let zoomLevel = parseFloat(this.jq.css(\"zoom\")) || 1;\n            this.jq.css(\"zoom\", zoomLevel + 0.1);\n        });\n        atom.commands.add(\"atom-workspace\", \"language-review:zoom-out\", () => {\n            let zoomLevel = parseFloat(this.jq.css(\"zoom\")) || 1;\n            this.jq.css(\"zoom\", zoomLevel - 0.1);\n        });\n        atom.commands.add(\"atom-workspace\", \"language-review:reset-zoom\", () => {\n            this.jq.css(\"zoom\", 1);\n        });\n\n        let changeHandler = () => {\n            let pane = atom.workspace.paneForURI(this.getURI());\n            if (pane && pane !== atom.workspace.getActivePane()) {\n                pane.activateItem(this);\n            }\n        };\n\n        this.runner.on(\"start\", () => {\n            this.showLoading();\n        });\n        this.runner.on(\"report\", reports => {\n            logger.log(reports);\n        });\n        this.runner.on(\"compile-success\", book => {\n            changeHandler();\n            book.allChunks[0].builderProcesses.forEach(process => {\n                let $html = this.resolveImagePaths(process.result);\n                this.jq.empty().append($html);\n            });\n        });\n        this.runner.on(\"compile-failed\", book => {\n            changeHandler();\n            let $result = $(\"<div>\");\n            book.allChunks[0].process.reports.forEach(report => {\n                let $report = $(\"<div>\");\n                let type = \"Unknown\";\n                switch (report.level) {\n                    case ReportLevel.Error:\n                        type = \"Error\";\n                        $report.addClass(\"text-error\");\n                        break;\n                    case ReportLevel.Warning:\n                        type = \"Warning\";\n                        $report.addClass(\"text-warning\");\n                        break;\n                    case ReportLevel.Info:\n                        type = \"Info\";\n                        $report.addClass(\"text-info\");\n                        break;\n                }\n\n                let line = report.nodes[0].location.start.line;\n                let column = report.nodes[0].location.start.column - 1;\n                $report.text(`[${line},${column}] ${type} ${report.message}`);\n                $report.appendTo($result);\n            });\n            this.jq.empty().append($result);\n        });\n\n        this.runner.activate();\n\n        if (this.runner.editor) {\n            atom.commands.add(\"atom-text-editor\", \"path-changed\", () => this.jq.trigger(\"title-changed\"));\n        }\n    }\n\n    renderReVIEW() {\n        this.runner.doCompile();\n    }\n\n    getTitle(): string {\n        if (this.file) {\n            return `${path.basename(this.getPath()) } Preview`;\n        } else if (this.editor) {\n            return `${this.editor.getTitle() } Preview`;\n        } else {\n            return \"Re:VIEW Preview\";\n        }\n    }\n\n    getURI(): string {\n        if (this.file) {\n            return `language-review://${this.getPath() }`;\n        } else {\n            return `language-review://${V.previewHost}/${this.editorId}`;\n        }\n    }\n\n    getPath(): string {\n        if (this.file) {\n            return this.file.getPath();\n        } else if (this.editor) {\n            return this.editor.getPath();\n        }\n        return null;\n    }\n\n    showError(result: any = {}) {\n        let failureMessage = result.message;\n\n        this.jq.html($$$(function() {\n            this.h2(\"Previewing Re:VIEW Failed\");\n            if (failureMessage) {\n                return this.h3(failureMessage);\n            }\n        }));\n    }\n\n    showLoading() {\n        this.jq.html($$$(function() {\n            this.div({ class: \"review-spinner\" }, \"Loading Re:VIEW\\u2026\");\n        }));\n    }\n\n    resolveImagePaths(html: any): JQuery {\n        let $html = $(html);\n        let imgList = $html.find(\"img\");\n        for (let i = 0; i < imgList.length; i++) {\n            let img = $(imgList[i]);\n            let src = img.attr(\"src\");\n            if (src.match(/^(https?:\\/\\/)/)) {\n                continue;\n            }\n            img.attr(\"src\", path.resolve(path.dirname(this.getPath()), src));\n        }\n\n        return $html;\n    }\n}\n\natom.deserializers.add(ReVIEWPreviewView);\n"]}
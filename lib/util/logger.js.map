{"version":3,"file":"logger.js","sourceRoot":"","sources":["logger.ts"],"names":["isEnableOutput","getCallSites","getCallSites.MyError","getCallSites.MyError.constructor","logHelper","log","warn","error"],"mappings":"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","sourcesContent":["\"use strict\";\n\n/* tslint:disable:ban */\n\nfunction isEnableOutput(): boolean {\n    \"use strict\";\n\n    return !!atom.config.get(\"language-review.debug\");\n}\n\ninterface CallSite {\n    getThis(): any;\n    getTypeName(): string;\n    getFunction(): Function;\n    getFunctionName(): string;\n    getMethodName(): string;\n    getFileName(): string;\n    getLineNumber(): number;\n    getColumnNumber(): number;\n    getEvalOrigin(): any;\n    isToplevel(): boolean;\n    isEval(): boolean;\n    isNative(): boolean;\n    isConstructor(): boolean;\n}\n\nfunction getCallSites(strip = 2): CallSite[] {\n    \"use strict\";\n\n    class MyError extends Error {\n        constructor() {\n            super();\n            (Error as any).captureStackTrace(this, MyError);\n        }\n    }\n\n    let oldPrepareStackTrace = (Error as any).prepareStackTrace;\n    let callSites: any[];\n    (Error as any).prepareStackTrace = (error: any, stack: any) => {\n        callSites = stack;\n        return stack;\n    };\n    new MyError().stack;\n    (Error as any).prepareStackTrace = oldPrepareStackTrace;\n\n    if (!callSites) {\n        // NOTE https://github.com/atom/atom/pull/9181\n        // Error.prepareStackTrace が上書きできない\n        return null;\n    }\n\n    for (let i = 0; i < strip; i++) {\n        callSites.shift();\n    }\n\n    return callSites;\n}\n\nfunction logHelper(callback: () => void): void {\n    \"use strict\";\n\n    let callSites = getCallSites(3);\n    if (callSites) {\n        let callSite = callSites[0];\n        let label: string;\n        let functionName = callSite.getFunctionName();\n        if (functionName) {\n            label = functionName;\n        } else {\n            let fileName = callSite.getFileName();\n            label = `${fileName.substr(fileName.lastIndexOf(\"/\") + 1) }:${callSite.getLineNumber() }:${callSite.getColumnNumber() }`;\n        }\n        console.group(label);\n        console.log([callSite.getFileName(), callSite.getLineNumber(), callSite.getColumnNumber()]);\n        callback();\n        console.groupEnd();\n    } else {\n        callback();\n    }\n}\n\n/* tslint:disable:no-unused-variable */\n\nexport function log(...args: any[]): void {\n    \"use strict\";\n\n    if (isEnableOutput()) {\n        logHelper(() => {\n            console.log.apply(console, args);\n        });\n    }\n}\n\nexport function warn(...args: any[]): void {\n    \"use strict\";\n\n    if (isEnableOutput()) {\n        logHelper(() => {\n            console.warn.apply(console, args);\n        });\n    }\n}\n\nexport function error(...args: any[]): void {\n    \"use strict\";\n\n    if (isEnableOutput()) {\n        logHelper(() => {\n            console.error.apply(console, args);\n        });\n    }\n}\n\n/* tslint:enable:ban no-unused-variable */\n"]}
{"version":3,"file":"review-runner.js","sourceRoot":"","sources":["review-runner.ts"],"names":["SingleFileAnalyzer","SingleFileAnalyzer.constructor","SingleFileAnalyzer.inline_chap","SingleFileAnalyzer.inline_title","SingleFileAnalyzer.inline_chapref","SingleFileHTMLBuilder","SingleFileHTMLBuilder.constructor","SingleFileHTMLBuilder.inline_chap","SingleFileHTMLBuilder.inline_title","SingleFileHTMLBuilder.inline_chapref","ReVIEWRunner","ReVIEWRunner.constructor","ReVIEWRunner.startWatching","ReVIEWRunner.stopWatching","ReVIEWRunner.activate","ReVIEWRunner.deactivate","ReVIEWRunner.on","ReVIEWRunner.doCompile","ReVIEWRunner.getContent","ReVIEWRunner.getFilePath","EditorContentWatcher","EditorContentWatcher.constructor","EditorContentWatcher.startWatching","EditorContentWatcher.stopWatching","EditorContentWatcher.configureRunner","EditorContentWatcher.triggerCompile","EditorContentWatcher.activate","EditorContentWatcher.deactivate","EditorContentWatcher.getContent","EditorContentWatcher.getFilePath","FileContentWatcher","FileContentWatcher.constructor","FileContentWatcher.startWatching","FileContentWatcher.stopWatching","FileContentWatcher.configureRunner","FileContentWatcher.activate","FileContentWatcher.deactivate","FileContentWatcher.getContent","FileContentWatcher.getFilePath"],"mappings":"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","sourcesContent":["// check this https://github.com/yujinakayama/atom-lint/blob/master/lib/lint-runner.coffee\n\nimport EmitterSubscriberBase from \"./emissary-helper\";\nimport * as V from \"./const\";\nimport * as logger from \"./logger\";\n\nimport * as ReVIEW from \"review.js\";\nimport * as path from \"path\";\nimport * as fs from \"fs\";\n\nimport * as PrhValidator from \"reviewjs-prh\";\n\n// 別の.reを参照する構文を生かしておくとビルドエラーになるので潰しておく。\nclass SingleFileAnalyzer extends ReVIEW.DefaultAnalyzer {\n    inline_chap(builder: /* AcceptableSyntaxBuilder */ any) {\n        this.inlineDecorationSyntax(builder, \"chap\");\n    }\n\n    inline_title(builder: /* AcceptableSyntaxBuilder */ any) {\n        this.inlineDecorationSyntax(builder, \"title\");\n    }\n\n    inline_chapref(builder: /* AcceptableSyntaxBuilder */ any) {\n        this.inlineDecorationSyntax(builder, \"chapref\");\n    }\n}\n\n// 別の.reを参照する構文を生かしておくとビルドエラーになるので潰しておく。\nclass SingleFileHTMLBuilder extends ReVIEW.HtmlBuilder {\n    inline_chap(process: /* BuilderProcess */ any, node: /* InlineElementSyntaxTree */ any) {\n        process.out(\"第X章\");\n        return false;\n    }\n\n    inline_title(process: /* BuilderProcess */ any, node: /* InlineElementSyntaxTree */ any) {\n        process.out(\"章タイトル(仮)\");\n        return false;\n    }\n\n    inline_chapref(process: /* BuilderProcess */ any, node: /* InlineElementSyntaxTree */ any) {\n        process.out(\"第X章「章タイトル(仮)」\");\n        return false;\n    }\n}\n\nexport default class ReVIEWRunner extends EmitterSubscriberBase {\n\n    private watcher: IContentWatcher;\n\n    editor: AtomCore.IEditor;\n    file: PathWatcher.IFile;\n\n    lastAcceptableSyntaxes: ReVIEW.AcceptableSyntaxes;\n    lastSymbols: ReVIEW.Symbol[];\n    lastReports: ReVIEW.ProcessReport[];\n    lastBook: ReVIEW.Book;\n\n    constructor(params: { editor: AtomCore.IEditor; });\n    constructor(params: { file: PathWatcher.IFile; });\n    constructor(params: { editor?: AtomCore.IEditor; file?: PathWatcher.IFile; }) {\n        super();\n\n        this.editor = params.editor;\n        this.file = params.file;\n\n        if (this.editor) {\n            this.watcher = new EditorContentWatcher(this, this.editor);\n        } else if (this.file) {\n            this.watcher = new FileContentWatcher(this, this.file);\n        } else {\n            throw new Error(\"editor or file are required\");\n        }\n    }\n\n    startWatching(): void {\n        logger.log();\n        this.watcher.startWatching();\n    }\n\n    stopWatching(): void {\n        logger.log();\n        this.watcher.stopWatching();\n    }\n\n    activate(): void {\n        logger.log();\n        this.watcher.activate();\n    }\n\n    deactivate(): void {\n        logger.log();\n        this.watcher.deactivate();\n    }\n\n    on(eventNames: \"start\", callback: () => any): any;\n    on(eventNames: \"syntax\", callback: (acceptableSyntaxes: ReVIEW.AcceptableSyntaxes) => any): any;\n    on(eventNames: \"symbol\", callback: (symbols: ReVIEW.Symbol[]) => any): any;\n    on(eventNames: \"report\", callback: (reports: ReVIEW.ProcessReport[]) => any): any;\n    on(eventNames: \"compile-success\", callback: (book: ReVIEW.Book) => any): any;\n    on(eventNames: \"compile-failed\", callback: (book: ReVIEW.Book) => any): any;\n    on(eventNames: string, handler: Function): any;\n\n    // 後でReVIEWRunner.emissarified();している。特殊化されたオーバーロードのため。\n    on(eventNames: string, handler: Function): any {\n        throw new Error();\n    }\n\n    doCompile(): void {\n        logger.log();\n        this.emit(\"start\");\n        let currentPath: string = this.watcher.getFilePath() || \"ch01.re\";\n        let basePath: string = path.isAbsolute(currentPath) ? path.dirname(currentPath) : undefined;\n        let filename: string = path.basename(currentPath);\n\n        setTimeout(() => {\n            let files: { [path: string]: string; } = {};\n            files[filename] = this.watcher.getContent();\n            let result: { [path: string]: string; } = {\n            };\n            let validators: ReVIEW.Validator[] = [\n                new ReVIEW.DefaultValidator()\n            ];\n            let dirName: string;\n            if (this.editor) {\n                dirName = this.editor.getBuffer().file.getParent().getPath();\n            } else if (this.file) {\n                dirName = path.dirname(this.file.getPath());\n            }\n            let prhFilePath = path.join(dirName, \"prh.yml\");\n            if (fs.existsSync(prhFilePath)) {\n                try {\n                    validators.push(new PrhValidator.TextValidator(prhFilePath));\n                } catch (e) {\n                    atom.notifications.addWarning(\"prh.ymlの定義に誤りがあります。\\n\" + e);\n                }\n            }\n\n            ReVIEW.start(review => {\n                review.initConfig({\n                    basePath: basePath,\n                    read: path => Promise.resolve(files[path]),\n                    write: (path, content) => {\n                        result[path] = content;\n                        return Promise.resolve<void>(null);\n                    },\n                    listener: {\n                        onAcceptables: acceptableSyntaxes => {\n                            logger.log(acceptableSyntaxes);\n                            this.lastAcceptableSyntaxes = acceptableSyntaxes;\n                            this.emit(\"syntax\", acceptableSyntaxes);\n                        },\n                        onSymbols: symbols => {\n                            logger.log(symbols);\n                            this.lastSymbols = symbols;\n                            this.emit(\"symbol\", symbols);\n                        },\n                        onReports: reports => {\n                            logger.log(reports);\n                            this.lastReports = reports;\n                            this.emit(\"report\", reports);\n                        },\n                        onCompileSuccess: book => {\n                            logger.log(book);\n                            this.lastBook = book;\n                            this.emit(\"compile-success\", book);\n                        },\n                        onCompileFailed: book => {\n                            logger.log();\n                            this.lastBook = null;\n                            this.emit(\"compile-failed\", book);\n                        }\n                    },\n                    analyzer: new SingleFileAnalyzer(),\n                    validators: validators,\n                    builders: [new SingleFileHTMLBuilder(false)],\n                    book: {\n                        contents: [\n                            filename\n                        ]\n                    }\n                });\n            });\n        });\n    }\n\n    getContent() {\n        return this.watcher.getContent();\n    }\n\n    getFilePath() {\n        return this.watcher.getFilePath();\n    }\n}\n\nReVIEWRunner.emissarified();\n\ninterface IContentWatcher {\n    startWatching(): void;\n    stopWatching(): void;\n    activate(): void;\n    deactivate(): void;\n    getContent(): string;\n    getFilePath(): string;\n}\n\nclass EditorContentWatcher extends EmitterSubscriberBase implements IContentWatcher {\n\n    buffer: TextBuffer.ITextBuffer;\n\n    grammerChangeSubscription: AtomCore.IDisposable;\n    wasAlreadyActivated: boolean;\n    bufferSubscriptions: AtomCore.IDisposable[] = [];\n    lastKeyHitTimeoutId: any;\n    static IN_EDIT_COMPILE_TIMEOUT: number = 3000;\n\n    constructor(public runner: ReVIEWRunner, public editor: AtomCore.IEditor) {\n        super();\n        this.buffer = this.editor.getBuffer();\n    }\n\n    startWatching(): void {\n        logger.log();\n        if (this.grammerChangeSubscription) {\n            return;\n        }\n\n        this.configureRunner();\n\n        this.grammerChangeSubscription = this.editor.onDidChangeGrammar(() => this.configureRunner());\n    }\n\n    stopWatching(): void {\n        logger.log();\n        if (!this.grammerChangeSubscription) {\n            return;\n        }\n\n        this.grammerChangeSubscription.dispose();\n        this.grammerChangeSubscription = null;\n    }\n\n    configureRunner(): void {\n        let scopeName = this.editor.getGrammar().scopeName;\n        logger.log(\"configureRunner grammar \" + scopeName);\n        if (V.reviewScopeName === scopeName) {\n            this.activate();\n        } else {\n            this.deactivate();\n        }\n    }\n\n    triggerCompile(withDelay: boolean = false): void {\n        if (this.lastKeyHitTimeoutId) {\n            clearTimeout(this.lastKeyHitTimeoutId);\n        }\n        if (withDelay) {\n            this.lastKeyHitTimeoutId = setTimeout(() => {\n                this.lastKeyHitTimeoutId = null;\n                this.runner.doCompile();\n            }, EditorContentWatcher.IN_EDIT_COMPILE_TIMEOUT);\n        } else {\n            this.lastKeyHitTimeoutId = null;\n            this.runner.doCompile();\n        }\n    }\n\n    activate(): void {\n        logger.log();\n        if (!this.wasAlreadyActivated) {\n            this.emit(\"activate\");\n        }\n        this.wasAlreadyActivated = true;\n        this.runner.doCompile();\n        if (this.bufferSubscriptions.length !== 0) {\n            return;\n        }\n        this.bufferSubscriptions.push(this.buffer.onDidChange(() => this.triggerCompile(true)));\n        this.bufferSubscriptions.push(this.buffer.onDidSave(() => this.triggerCompile()));\n        this.bufferSubscriptions.push(this.buffer.onDidReload(() => this.triggerCompile()));\n    }\n\n    deactivate(): void {\n        logger.log();\n        this.bufferSubscriptions.forEach(subscription => subscription.dispose());\n        this.bufferSubscriptions = [];\n        this.runner.emit(\"deactivate\");\n    }\n\n    getContent(): string {\n        return this.editor.buffer.getText();\n    }\n\n    getFilePath(): string {\n        return this.buffer.getUri();\n    }\n}\n\nclass FileContentWatcher extends EmitterSubscriberBase implements IContentWatcher {\n\n    fileRemovedSubscription: AtomCore.IDisposable;\n    wasAlreadyActivated: boolean;\n    contentChangedSubscription: AtomCore.IDisposable;\n\n    constructor(public runner: ReVIEWRunner, public file: PathWatcher.IFile) {\n        super();\n    }\n\n    startWatching(): void {\n        logger.log();\n        if (this.fileRemovedSubscription) {\n            return;\n        }\n\n        this.configureRunner();\n\n        this.file.onDidDelete\n        this.fileRemovedSubscription = this.file.onDidDelete(() => {\n            this.configureRunner();\n        });\n    }\n\n    stopWatching(): void {\n        logger.log();\n        if (!this.fileRemovedSubscription) {\n            return;\n        }\n\n        this.fileRemovedSubscription.dispose();\n        this.fileRemovedSubscription = null;\n    }\n\n    configureRunner(): void {\n        if (this.file.existsSync()) {\n            this.activate();\n        } else {\n            this.deactivate();\n        }\n    }\n\n    activate(): void {\n        logger.log();\n        if (!this.wasAlreadyActivated) {\n            this.emit(\"activate\");\n        }\n        this.wasAlreadyActivated = true;\n        this.runner.doCompile();\n        if (this.contentChangedSubscription) {\n            return;\n        }\n        this.contentChangedSubscription = this.file.onDidDelete(() => {\n            this.runner.doCompile();\n        });\n    }\n\n\n    deactivate(): void {\n        logger.log();\n        if (this.contentChangedSubscription) {\n            this.contentChangedSubscription.dispose();\n            this.contentChangedSubscription = null;\n        }\n        this.runner.emit(\"deactivate\");\n    }\n\n    getContent(): string {\n        return this.file.readSync(false);\n    }\n\n    getFilePath(): string {\n        return this.file.getRealPathSync();\n    }\n}\n"]}